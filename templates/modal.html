$def with (mail,type, id)	
$var recursive : True
$code :
    allElem = c.findAllFromType(type)
    elem = allElem.elements[id]
    keyID = allElem.keyColumn
    permissionKey = type +'_'

$var lang : $c.connectedUsers.users[mail].cuser.fields['language']  

	    <!-- Modal content-->
	    <div class="modal-content">
            <div class="modal-header row ">
		<div class="col-xs-2" >
		    <strong><span class="$c.AllHalflings.elements[allElem.get_name_object()].getHalfling()"></span></strong>
		</div>
                <h4 class="modal-title col-xs-6 ">$elem.getName(self.lang)</h4>
		<div class="col-xs-2" >
		</div>
                <button type="button" class="col-xs-2 btn btn-primary" data-dismiss="modal"><strong><big>&times;</big></strong></button>
            </div>
            <div class="modal-body">
                <div class="container-fluid">
                    <div class="row">
			$if type in 'pecbgugfgr' and elem.isImaged():
			    <div class="col-xs-5">
				<img src="/$(elem.getImageDirectory())jpg" alt="Image not found" style="width:128px;height:128px;">
			    </div>
			<div id="modalinfo" class="col-xs-5">
			    <strong>$elem.fields['acronym']</strong>
			</div>
			<div id="modalinfo" class="col-xs-1">
			    $if elem.fields['active'] == '1' or elem.fields['active'] == 1 :
				<span class="glyphicon glyphicon-ok-circle"> </span>
			    $else :
				<span class="glyphicon glyphicon-remove-circle"> </span>		    
			</div>
                    </div>
		    <button type="button" class="btn btn-warning btn-md flip" data-toggle="modal" data-target="#modal_menu_$(type)_$(id)"><span class="$c.AllHalflings.elements['menu'].getHalfling()"></span></button>
		    
                    $if type != 'u':
                        $for lg in c.AllLanguages.elements.keys():
                            <div class="row">
                            <div class="col-xs-2">
                                $lg
                            </div>
                            <div class="col-xs-10" id="modalinfo" >
                                $elem.getName(lg)
                            </div>
                            </div>
                    $else:
                        <div class="row" id="listingMarge">
                            <div class="col-xs-3">
                            $c.AllMessages.elements['name'].getName(self.lang) :
                            </div>
                            <div class="col-xs-9" id="modalinfo" >
                            $elem.getName(self.lang)
                            </div>
                        </div>
		    $if type in 'cpebu':
			$code :
			    groups = c.get_group(allElem.get_key_group())
			$if elem.get_group() != '' :
			    <div class="row" id="listingMarge">
				<div class="col-xs-3">
				    $c.AllMessages.elements['group'].getName(self.lang) :
				</div>
				<div class="col-xs-9" id="modalinfo" >
				    $groups.elements[elem.get_group()].fields['acronym']
				</div>
			    </div>
		    
		    $if type in 'bce':
			<div class="row">
			    <div class="col-xs-3" >
				<strong><a href="/find/t/$(type)_$id" class="btn btn-warning" role="button"><span class="$c.AllHalflings.elements['transfer'].getHalfling()"></span></a></strong>
			    </div>
			</div>	

                    $if type == 'm':
                        <div class="row" style="margin-top:10px;">
                            <div class="col-xs-4">
                            $c.AllMessages.elements['source'].getName(self.lang) :
                            </div>
                            <div class="col-xs-8" id="modalinfo" >
                            $elem.fields['source']
                            </div>
                        </div>
                        <div class="row" style="margin-top:10px;">
                            <div class="col-xs-4">
                            $c.AllMessages.elements['formula'].getName(self.lang) :
                            </div>
                            <div class="col-xs-8" id="modalinfo" >
                            $if elem.fields['formula'] != '':
                                $elem.fields['formula']
                            $else : 
                                -
                            </div>
                        </div>
                        <div class="row" style="margin-top:10px;">
                            <div class="col-xs-4">
                            $c.AllMessages.elements['unit'].getName(self.lang) :
                            </div>
                            <div class="col-xs-8" id="modalinfo" >
                            $elem.fields['unit']
                            </div>
                        </div>
                        
                    $elif type == 'a':
                        $if elem.fields['o_sms1'] != '':
                            <div class="row" style="margin-top:10px;">
                                <div class="col-xs-4">
                                $c.AllMessages.elements['phone'].getName(self.lang) 1:
                                </div>
                                <div class="col-xs-8" id="modalinfo" >
                                $c.AllGrFunction.elements[elem.fields['o_sms1']].getName(self.lang)
                                </div>
                            </div>
                        $if elem.fields['o_email1'] != '':
                            <div class="row" style="margin-top:10px;">
                                <div class="col-xs-4">
                                $c.AllMessages.elements['mail'].getName(self.lang) 1:
                                </div>
                                <div class="col-xs-8" id="modalinfo" >
                                $c.AllGrFunction.elements[elem.fields['o_email1']].getName(self.lang)
                                </div>
                            </div>
                        $if elem.fields['o_sound1'] != '':
                            <div class="row" style="margin-top:10px;">
                                <div class="col-xs-4">
                                $c.AllMessages.elements['sound'].getName(self.lang) 1:
                                </div>
                                <div class="col-xs-8" id="modalinfo" >
                                $c.AllGrFunction.elements[elem.fields['o_sound1']].getName(self.lang)
                                </div>
                            </div>
                        $if elem.fields['relay1'] != '':
                            <div class="row" style="margin-top:10px;">
                                <div class="col-xs-4">
                                $c.AllMessages.elements['relay'].getName(self.lang) 1:
                                </div>
                                <div class="col-xs-8" id="modalinfo" >
                                $elem.fields['relay1']
                                </div>
                            </div>
                        $if elem.fields['o_sms2'] != '':
                            <div class="row" style="margin-top:10px;">
                                <div class="col-xs-4">
                                $c.AllMessages.elements['phone'].getName(self.lang) 2:
                                </div>
                                <div class="col-xs-8" id="modalinfo" >
                                $c.AllGrFunction.elements[elem.fields['o_sms2']].getName(self.lang)
                                </div>
                            </div>
                        $if elem.fields['o_email2'] != '':
                            <div class="row" style="margin-top:10px;">
                                <div class="col-xs-4">
                                $c.AllMessages.elements['mail'].getName(self.lang) 2:
                                </div>
                                <div class="col-xs-8" id="modalinfo" >
                                $elem.fields['o_email2']
                                </div>
                            </div>
                        $if elem.fields['o_sound2'] != '':
                            <div class="row" style="margin-top:10px;">
                                <div class="col-xs-4">
                                $c.AllMessages.elements['sound'].getName(self.lang) 1:
                                </div>
                                <div class="col-xs-8" id="modalinfo" >
                                $c.AllGrFunction.elements[elem.fields['o_sound2']].getName(self.lang)
                                </div>
                            </div>
                        $if elem.fields['relay2'] != '':
                            <div class="row" style="margin-top:10px;">
                                <div class="col-xs-4">
                                $c.AllMessages.elements['relay'].getName(self.lang) 2:
                                </div>
                                <div class="col-xs-8" id="modalinfo" >
                                $elem.fields['relay2']
                                </div>
                            </div>
                    $elif type == 's':
                        <div class="row" style="margin-top:10px;">
                            <div class="col-xs-4">
                                $c.AllMessages.elements['component'].getName(self.lang) :
                            </div>
                            <div class="col-xs-8" id="modalinfo" >
                                $if not elem.fields['p_id'] == '' :
                                    <a href="/list/p">$c.AllPieces.elements[elem.fields['p_id']].getName(self.lang)</a>
                                $elif not elem.fields['e_id'] == '' :
                                    <a href="/list/e">$c.AllEquipments.elements[elem.fields['e_id']].getName(self.lang)</a>
                                $elif not elem.fields['c_id'] == '' :
                                    <a href="/list/c">$c.AllContainers.elements[elem.fields['c_id']].getName(self.lang)</a>
                            </div>
                        </div>
                        <div class="row" style="margin-top:10px;">
                            <div class="col-xs-4">
                                $c.AllMessages.elements['measure'].getName(self.lang) :
                            </div>
                            <div class="col-xs-8" id="modalinfo" >
                                <a href="/list/m">$c.AllMeasures.elements[elem.fields['m_id']].getName(self.lang)</a>
                            </div>
                        </div>
                        <div class="row" style="margin-top:10px;">
                            <div class="col-xs-4">
                                $c.AllMessages.elements['formula'].getName(self.lang) :
                            </div>
                            <div class="col-xs-8" id="modalinfo" >
                                $elem.fields['formula']
                            </div>
                        </div>
                        <div class="row" style="margin-top:10px;">
                            <div class="col-xs-4">
                                $c.AllMessages.elements['sensor'].getName(self.lang) :
                            </div>
                            <div class="col-xs-8" id="modalinfo" >
                                $elem.fields['sensor']
                            </div>
                        </div>
                        <div class="row" style="margin-top:10px;">
                            <div class="col-xs-4">
                                $c.AllMessages.elements['subsensor'].getName(self.lang) :
                            </div>
                            <div class="col-xs-8" id="modalinfo" >
                                $elem.fields['subsensor']
                            </div>
                        </div>
		    $elif type == 'b':
			<div class="row" style="margin-top:10px;">
                            <div class="col-xs-4">
                                $c.AllMessages.elements['measure'].getName(self.lang) :
                            </div>
                            <div class="col-xs-8" id="modalinfo" >
				$if elem.fields['m_id'] != '' :
				    $c.AllMeasures.elements[elem.fields['m_id']].getName(self.lang)
				$else:
				    -
                            </div>
                        </div>
			<div class="row" style="margin-top:10px;">
                            <div class="col-xs-4">
                                $c.AllMessages.elements['quantity'].getName(self.lang) :
                            </div>
                            <div class="col-xs-8" id="modalinfo" >
				$if elem.fields['basicqt'] != '' :
				    $elem.fields['basicqt']
				$else :
				    -
                            </div>
                        </div>
			<div class="row" style="margin-top:10px;">
                            <div class="col-xs-4">
                                $c.AllMessages.elements['cost'].getName(self.lang) :
                            </div>
                            <div class="col-xs-8" id="modalinfo" >
                                $if elem.fields['cost'] != '' :
				    $elem.fields['cost']
				$else :
				    -
                            </div>
                        </div>
		    $code :
			barcode = c.AllBarcodes.get_barcode(elem.get_type(), elem.id)
		    $if barcode != '' :
                        <div class="row" style="margin-top:10px;">
                            <div class="col-xs-4">
				<strong><a href="/barcode/$(c.AllBarcodes.get_barcode(elem.get_type(), elem.id))" class="btn btn-warning" role="button"><span class="$c.AllHalflings.elements['barcode'].getHalfling()"></span></a></strong>
                            </div>
                            <div class="col-xs-8" id="modalinfo" >
				<a href="/barcode/$(barcode)">$(barcode)</a>
                            </div>
                        </div>
		    $if elem.fields['remark'] != '' :
	                <div class="row" style="margin-top:3px;">
                            <div class="col-xs-4">
                                $c.AllMessages.elements['remark'].getName(self.lang) :
                            </div>
                            <div class="col-xs-8" id="modalinfo" >
				$elem.fields['remark']
                            </div>
                        </div>
                    
                    $if 'colorgraph' in elem.fields :
                        <div class="row" style="margin-top:3px;" >
                            <div class="col-xs-4">
                            $c.AllMessages.elements['color'].getName(self.lang) 
                            </div>
                            <div class="col-xs-8" style="background-color:$elem.fields['colorgraph'];" >$elem.fields['colorgraph']
                            </div>
                        </div>
                    
                    <div class="row" style="margin-top:3px;">
                        <div class="col-xs-4">
                            $c.AllMessages.elements['created'].getName(self.lang) :
                        </div>
                        <div class="col-xs-8" id="modalinfo" >
                            <strong>$c.AllUsers.elements[elem.creator].getName(self.lang) </strong> - <em>$elem.created</em>
                        </div>
                    </div>
                    <div class="row" style="margin-top:3px;">
                        <div class="col-xs-4">
                            <strong><a href="/edit/$(type)_$id" class="btn btn-warning" role="button"><span class="$c.AllHalflings.elements['edit'].getHalfling()"></span></a></strong>
                        </div>
                        <div class="col-xs-8" id="modalinfo" >
                            <strong>$c.AllUsers.elements[elem.fields['user']].getName(self.lang) </strong> - <em>$elem.fields['begin']</em>
                        </div>
                    </div>
                </div>
            </div>
            <div class="modal-footer">
		$if type in 'scpemb' :
		    <div class="col-xs-2" >
			<strong><a href="/find/d/$(type)_$(id)" class="btn btn-warning" role="button"><span class="$c.AllHalflings.elements['manualdata'].getHalfling()"></span></a></strong>
		    </div>
		$else :
		    <div class="col-xs-2" >
		    </div>
		$if type in 'cpem':
		    <div class="col-xs-2" >
			<strong><a href="/find/related/$(type)_$id" class="btn btn-warning" role="button"><span class="$c.AllHalflings.elements['related'].getHalfling()"></span></a></strong>
		    </div>
		$elif type in 'b' :
		    <div class="col-xs-2" >
			<strong><a href="/find/v/$(type)_$id" class="btn btn-warning" role="button"><span class="$c.AllHalflings.elements['pouring'].getHalfling()"></span></a></strong>
		    </div>
		$else :
		    <div class="col-xs-2" >
		    </div>
		$if type in 'cpesm':
		    <div class="col-xs-2" >
			<strong><a href="/graphic/$(type)_$id" class="btn btn-warning" role="button"><span class="$c.AllHalflings.elements['graphic'].getHalfling()"></span></a></strong>
		    </div>
		$else :
		    <div class="col-xs-2" >
		    </div>
		$if type in 'cpeb':
		    <div class="col-xs-2">
			<strong><a href="/export/$(type)_$(id)" class="btn btn-warning" role="button"><span class="$c.AllHalflings.elements['exportdata'].getHalfling()"></span></a></strong>
		    </div>
		$else :
		    <div class="col-xs-2" >
		    </div>
	        <div class="col-xs-2" >
	        </div>
		<button type="button" class="col-xs-2 btn btn-primary" data-dismiss="modal"><strong><big>&times;</big></strong></button>
            </div>
        </div>
<script>
    $$(document).ready(function(){
	$$('.flip').on("click",function(e){
	    $$('#modal_$(type)_$(id)').modal('hide');
	});
    });
</script>
